{% extends 'base.html' %}

{% block content %}
<h1>Piezas de cer√°mica</h1>

{% if user.is_authenticated %}
<div style="margin-bottom: 20px;">
    <a href="{% url 'crear_pieza' %}" style="
        background-color: #d9bfa3;
        color: #4b2e2e;
        padding: 10px 18px;
        border-radius: 8px;
        text-decoration: none;
        font-weight: bold;
        box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
        display: inline-block;">
        + Agregar nueva pieza
    </a>
</div>
{% endif %}

<!-- Buscador -->
<form method="get" action="{% url 'lista_piezas' %}" style="margin-bottom: 20px;">
    <input type="text" name="q" placeholder="Buscar por t√≠tulo..." value="{{ request.GET.q }}"
        style="padding: 8px; border-radius: 6px; border: 1px solid #ccc;">
    <button type="submit"
        style="padding: 8px 14px; background-color: #b7936f; color: white; border: none; border-radius: 6px;">
        üîç Buscar
    </button>
</form>

<!-- Lista de piezas -->
{% if piezas %}
<ul>
    {% for pieza in piezas %}
    <li style="margin-bottom: 40px;">
        <h2>{{ pieza.titulo }}</h2>
        <p><strong>T√©cnica:</strong> {{ pieza.tecnica }}</p>
        <p>{{ pieza.descripcion|safe }}</p>
        {% if pieza.imagen %}
        <img src="{{ pieza.imagen.url }}" alt="{{ pieza.titulo }}" style="
            width: 200px;
            height: 200px;
            object-fit: cover;
            border-radius: 8px;
            display: block;
            box-shadow: 2px 2px 8px rgba(0,0,0,0.1);
        ">
        {% endif %}
        <div style="margin-top: 10px;">
            <a href="{% url 'detalle_pieza' pieza.pk %}">Leer m√°s</a>
            {% if user.is_authenticated %}
            |
            <a href="{% url 'borrar_pieza' pieza.pk %}" style="color: red;"
                onclick="return confirm('¬øSeguro que quer√©s borrar esta pieza?');">Borrar</a>
            {% endif %}
        </div>
    </li>
    {% endfor %}
</ul>
{% else %}
<p>No hay p√°ginas a√∫n.</p>
{% endif %}

{% endblock %}